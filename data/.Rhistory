setwd("~/GitHub/OCRugVARKS/data")
data <- read.csv("bank-full.csv", TRUE, ';')
library(randomForest)
library(caret)
library(ggplot2)
library(dplyr)
library(lubridate)
library(scales)
colory <- "#56a8e8"
colorn <- "grey75"
#Remove unncessary columns
data_c <- subset(data, select =-c(duration, day, month()))
#Remove unncessary columns
data_c <- subset(data, select =-c(duration, day, month)
#Remove unncessary columns
data_c <- subset(data, select =-c(duration, day, month))
#Remove unncessary columns
data_c <- subset(data, select =-c(duration, day, month))
table(data_c$y)
#Create synthetic data
install.packages("DMwR")
library(DMwR)
newData_c <- SMOTE(Species ~ ., data_c, perc.over = 600,perc.under=100)
newData_c <- SMOTE(y ~ ., data_c, perc.over = 600,perc.under=100)
table(newData_c$y)
View(newData_c)
set.seed(1234)
ind <- sample(2,nrow(newData_c), replace = TRUE, prob = c(0.7,0.3))
train <- newData_c[ind==1,]
test <- newData_c[ind==2,]
rf <- randomForest(y~., data=train)
print(rf)
#Prediction & Confusion Matrix - train data
library(caret)
p1 <- predict(rf, train)
confusionMatrix(p1, train$y)
#Prediction & Confusion MAtrix - test data
p2 <- predict(rf, test)
confusionMatrix(p2, test$y)
#Create og test and train
ind <- sample(2,nrow(data_c), replace = TRUE, prob = c(0.7,0.3))
og_train <- data_c[ind==1,]
og_test <- data_c[ind==2,]
p3 <- predict(rf, og_train)
confusionMatrix(p1, og_train$y)
#Prediction & Confusion MAtrix - test data
p4 <- predict(rf, og_test)
confusionMatrix(p2, og_test$y)
rm(p3,p4, og_train, og_test)
confusionMatrix(p1, train$y)
confusionMatrix(p2, test$y)
print(rf)
varImp(rf)
varImpPlot(rf)
partialPlot(rf)
